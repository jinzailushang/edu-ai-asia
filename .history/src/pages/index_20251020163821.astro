---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import TrustSection from '../components/TrustSection.astro';
import ValueProposition from '../components/ValueProposition.astro';
import DomainCard from '../components/DomainCard.astro';
import type { Domain } from '../types/domain';
import domainsData from '../data/domains.json';
import siteConfig from '../config/site.json';

const domains = domainsData as Domain[];
const locale = 'zh';

// 分离推荐域名和普通域名
const featuredDomains = domains.filter(d => d.featured && d.status === 'available');
const regularDomains = domains.filter(d => !d.featured && d.status === 'available');

// 获取所有唯一的分类
const categories = [...new Set(domains.map(d => d.category))];

// SEO 优化的关键词
const pageKeywords = [
  'AI域名出售',
  'edu-ai.asia',
  'AI教育域名',
  'AI医疗域名',
  'aidesigner域名',
  '优质域名购买',
  'AI品牌域名'
];
---

<BaseLayout locale={locale} keywords={pageKeywords}>
  <Hero locale={locale} />
  
  <!-- 推荐域名 -->
  {featuredDomains.length > 0 && (
    <section class="py-16 bg-white" aria-labelledby="featured-domains-heading">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <header class="text-center mb-12">
          <div class="inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-gradient-start to-gradient-end text-white rounded-full text-sm font-semibold mb-4" role="status">
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
            </svg>
            推荐域名
          </div>
          <h2 id="featured-domains-heading" class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
            精选优质域名
          </h2>
          <p class="text-xl text-gray-600">
            最具价值和潜力的 AI 域名推荐
          </p>
        </header>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" role="list">
          {featuredDomains.map((domain) => (
            <article role="listitem">
              <DomainCard domain={domain} locale={locale} />
            </article>
          ))}
        </div>
      </div>
    </section>
  )}
  
  <!-- 所有域名列表 -->
  <section class="py-16 bg-gray-50" aria-labelledby="all-domains-heading">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 id="all-domains-heading" class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
          全部域名
        </h2>
        <p class="text-xl text-gray-600">
          专业筛选的 AI 行业域名，助力您的品牌发展
        </p>
      </header>
      
      <!-- 分类筛选 -->
      <nav class="flex flex-wrap justify-center gap-3 mb-12" aria-label="域名分类筛选">
        <button 
          class="filter-btn px-6 py-2 rounded-full font-medium transition-all duration-300 bg-primary text-white"
          data-category="all"
          aria-label="显示全部域名"
          aria-pressed="true"
        >
          全部
        </button>
        {categories.map((category) => (
          <button 
            class="filter-btn px-6 py-2 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100"
            data-category={category}
            aria-label={`筛选${category}类别`}
            aria-pressed="false"
          >
            {category}
          </button>
        ))}
      </nav>
      
      <div id="domain-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" role="list">
        {domains.map((domain) => (
          <article class="domain-item" data-category={domain.category} role="listitem">
            <DomainCard domain={domain} locale={locale} />
          </article>
        ))}
      </div>
      
      <!-- 无结果提示 -->
      <div id="no-results" class="hidden text-center py-12" role="status" aria-live="polite">
        <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <p class="text-xl text-gray-600">暂无符合条件的域名</p>
      </div>
    </div>
  </section>
  
  <ValueProposition locale={locale} />
  <TrustSection locale={locale} />
  
  <!-- CTA 区域 -->
  <section class="py-16 bg-gradient-to-r from-primary to-gradient-end" aria-labelledby="cta-heading">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 id="cta-heading" class="text-3xl sm:text-4xl font-bold text-white mb-4">
        找到心仪的域名了吗？
      </h2>
      <p class="text-xl text-blue-100 mb-8">
        立即联系我们，获取专业的域名购买咨询服务
      </p>
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
        <a 
          href={`tel:${siteConfig.contact.phone}`}
          class="inline-flex items-center px-8 py-4 bg-white text-primary text-lg font-semibold rounded-lg hover:shadow-lg hover:scale-105 transition-all duration-300"
          aria-label="立即咨询域名"
        >
          立即咨询
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
          </svg>
        </a>
        <a 
          href="tel:13352963461"
          class="inline-flex items-center px-8 py-4 bg-transparent text-white text-lg font-semibold rounded-lg border-2 border-white hover:bg-white hover:text-primary transition-all duration-300"
          aria-label="拨打电话 13352963461"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
          </svg>
          13352963461
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<!-- Schema.org 结构化数据 - ItemList -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "优质 AI 域名列表",
  "description": "专业筛选的 AI 行业域名，助力您的品牌发展",
  "numberOfItems": domains.filter(d => d.status === 'available').length,
  "itemListElement": domains.filter(d => d.status === 'available').map((domain, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "item": {
      "@type": "Product",
      "name": domain.name,
      "description": domain.content.zh.description,
      "url": new URL(`/domains/${domain.id}`, Astro.site || 'https://edu-ai.asia').toString(),
      "offers": {
        "@type": "Offer",
        "availability": "https://schema.org/InStock",
        "price": domain.priceRange || "面议",
        "priceCurrency": "USD"
      }
    }
  }))
})} />

<!-- Schema.org 结构化数据 - CollectionPage -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "优质 AI 域名销售",
  "description": "专业的 AI 域名销售平台，提供优质域名，助力您的品牌发展",
  "url": Astro.site?.toString() || 'https://edu-ai.asia',
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": domains.filter(d => d.status === 'available').length
  }
})} />

<script>
  // 域名筛选功能
  document.addEventListener('DOMContentLoaded', () => {
    const filterBtns = document.querySelectorAll('.filter-btn');
    const domainItems = document.querySelectorAll('.domain-item');
    const noResults = document.getElementById('no-results');
    
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const category = btn.getAttribute('data-category');
        
        // 更新按钮样式
        filterBtns.forEach(b => {
          b.classList.remove('bg-primary', 'text-white');
          b.classList.add('bg-white', 'text-gray-700');
        });
        btn.classList.remove('bg-white', 'text-gray-700');
        btn.classList.add('bg-primary', 'text-white');
        
        // 筛选域名
        let visibleCount = 0;
        domainItems.forEach(item => {
          const itemCategory = item.getAttribute('data-category');
          if (category === 'all' || itemCategory === category) {
            item.style.display = 'block';
            visibleCount++;
          } else {
            item.style.display = 'none';
          }
        });
        
        // 显示/隐藏无结果提示
        if (noResults) {
          noResults.classList.toggle('hidden', visibleCount > 0);
        }
      });
    });
  });
</script>
